# Test stage jobs

# Test-Job: führt ScalaTest aus (siehe Guidelines)
run-tests:
  stage: test
  needs: ["build-game"]
  rules:
    - if: "$CI_PIPELINE_SOURCE == 'push' || $CI_PIPELINE_SOURCE == 'merge_request_event'"
  variables:
    # Falls Tests GUI/JavaFX tangieren, bleiben sie headless; Monocle-Flags optional aktivieren
    TEST_JAVA_OPTS: "-Djava.awt.headless=true -Dtestfx.headless=true -Dprism.order=sw -Dglass.platform=Monocle -Dmonocle.platform=Headless"
  script:
    - echo "Running tests"
    - sbt -v test
  artifacts:
    when: always
    expire_in: 1 week
    paths:
      - target/scala-*/test-reports
      - target/test-reports
      - target/**/scoverage-report
    reports:
      # Falls ihr JUnit-XML erzeugt (z. B. via sbt-junit-Interface), könnt ihr das hier reporten
      junit:
        - target/test-reports/*.xml
        - target/scala-*/test-reports/*.xml
